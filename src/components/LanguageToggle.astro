---
const { currentLang = "es" } = Astro.props;
---

<div class="relative w-14 h-8 select-none">
  <input
    type="checkbox"
    class="sr-only peer"
    id="lang-switch"
    checked={currentLang === "en"}
    aria-label="Cambiar idioma"
    onChange={() => {
      const lang = currentLang === "es" ? "en" : "es";
      // Guardar posición scroll antes de recargar
      sessionStorage.setItem("savedScroll", window.scrollY);
      // Modificar URL con nuevo idioma
      const url = new URL(window.location.href);
      url.searchParams.set("lang", lang);
      window.location.href = url.toString();
    }}
  />
  <label for="lang-switch" class="block w-14 h-8 bg-white/10 border border-blue-400/30 rounded-full cursor-pointer shadow-inner transition peer-checked:bg-blue-400/20"></label>
  <div class="dot absolute top-1 left-1 w-6 h-6 rounded-full transition-all duration-300 bg-white shadow-lg flex items-center justify-center text-lg pointer-events-none
    peer-checked:translate-x-6 border border-blue-300">
    <img
      src={currentLang === "en" ? "/img/eng.png" : "/img/esp.png"}
      alt={currentLang === "en" ? "English" : "Español"}
      class="w-5 h-5"
      draggable="false"
    />
  </div>
</div>

<script is:inline>
  if (typeof window !== "undefined") {
    window.addEventListener("load", () => {
      const savedScroll = sessionStorage.getItem("savedScroll");
      if (savedScroll) {
        window.scrollTo(0, parseInt(savedScroll, 10));
        sessionStorage.removeItem("savedScroll");
      }
    });
  }
</script>

<style>
  .dot {
    transition: all 0.3s cubic-bezier(.4,0,.2,1);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    pointer-events: none;
  }
</style>
